<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Aria-owns demos</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

    <!-- JavaScript code prettifier -->
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>

    <style>
      .btn {
        width: 200px;
      }

      [role="row"] {
        border-collapse: collapse;
        margin-top: -1px;
      }
      [role="gridcell"] {
        display: table-cell;
        border: 1px solid #ddd;
        padding: 10px 15px;
      }
    </style>

  </head>
  <body>
    <div class="container" role="main">
      <div class="jumbotron">
        <h1>Aria-owns demos</h1>
        <p>
          This page demonstrates support for
          <a href="http://www.w3.org/TR/wai-aria/states_and_properties#aria-owns">aria-owns</a>
          in Google Chrome 45.
        </p>
        <p>
          The aria-owns property has been part of the ARIA spec for a long
          time, but historically, implementation has relied on AT support,
          which can be difficult and expensive to get right. Starting in
          version 45, Google Chrome implements aria-owns by automatically
          rearranging the accessibility tree.
        </p>
      </div>

      <div id="version-alert" class="alert alert-danger" role="alert">
        <p>
          <strong>Oops! The browser you're using isn't a new enough version of Google Chrome.</strong>
        </p>
        <p>
          Your user agent is:
          <span id="useragent"></span>.
        </p>
        <p>
          The Chrome version should be 45, and the branch number (the third
          number in the version string) should be 2441 or higher.
        </p>
        <p>
          You're still welcome to check out this
          page, but the aria-owns examples probably won't work!
        </p>
      </div>
      <script>
        document.getElementById("useragent").textContent = navigator.userAgent;
        var m = navigator.userAgent.match(/Chrome\/([0-9]+)\.[0-9]+\.([0-9]+)/);
        console.log('Version: ' + m[1] + ' : ' + m[2]);
        if (m && parseInt(m[1], 10) >= 45 && parseInt(m[2], 10) >= 2441) {
          document.getElementById('version-alert').hidden = true;
        }
      </script>

      <h2>Moving nodes in the accessibility tree</h2>
      <p>
        The most basic use of aria-owns is to move a node in the accessibility
        tree. In this example, there are three profile images in a row, and
        immediately below each image is a button to open the profile.
        In the DOM, the three images come first and the three buttons
        come next, so the semantic order in the accessibility tree is wrong.
        With aria-owns we can move the buttons in the accessibility tree
        without affecting the DOM tree.
      </p>
      <p>
        Check out the code, then explore the before and after examples
        using a screen reader or accessibility inspection tool.
      </p>

      <pre>
<xmp class="prettyprint">      <div>
        <img src="redthumb.png" alt="Red profile">
        <span aria-owns="redbutton"></span>
        <img src="greenthumb.png" alt="Green profile">
        <span aria-owns="greenbutton"></span>
        <img src="bluethumb.png" alt="Blue profile">
        <span aria-owns="bluebutton"></span>
      </div>
      <div>
        <button id="redbutton">Red profile</button>
        <button id="greenbutton">Green profile</button>
        <button id="bluebutton">Blue profile</button>
      </div></xmp></pre>

      <h3>Without aria-owns</h3>
      <div>
        <img class="img-thumbnail" src="redthumb.png" alt="Red profile" width="200px">
        <img class="img-thumbnail" src="greenthumb.png" alt="Green profile" width="200px">
        <img class="img-thumbnail" src="bluethumb.png" alt="Blue profile" width="200px">
      </div>
      <div>
        <button class="btn btn-lg btn-danger">Red profile</button>
        <button class="btn btn-lg btn-success">Green profile</button>
        <button class="btn btn-lg btn-primary">Blue profile</button>
      </div>

      <h3>With aria-owns</h3>
      <div>
        <img class="img-thumbnail" src="redthumb.png" alt="Red profile" width="200px">
        <span aria-owns="redbutton"></span>
        <img class="img-thumbnail" src="greenthumb.png" alt="Green profile" width="200px">
        <span aria-owns="greenbutton"></span>
        <img class="img-thumbnail" src="bluethumb.png" alt="Blue profile" width="200px">
        <span aria-owns="bluebutton"></span>
      </div>
      <div>
        <button id="redbutton" class="btn btn-lg btn-danger">Red profile</button>
        <button id="greenbutton" class="btn btn-lg btn-success">Green profile</button>
        <button id="bluebutton" class="btn btn-lg btn-primary">Blue profile</button>
      </div>

      <h2>Reordering children</h2>
      <p>
        Another use of aria-owns is to keep the existing children of an HTML element,
        but simply reorder them so that it makes more sense for accessibility.
        In this example, the DOM order is backwards, but using aria-owns, the
        accessibility tree will have the list items in the correct order.
      </p>
      <pre>
<xmp class="prettyprint">      <ul aria-owns="first second third">
        <li id="third">Third</li>
        <li id="second">Second</li>
        <li id="first">First</li>
      </ul></xmp></pre>

      <h3>Without aria-owns</h3>
      <ul class="list-group">
        <li class="list-group-item">Third</li>
        <li class="list-group-item">Second</li>
        <li class="list-group-item">First</li>
      </ul>

      <h3>With aria-owns</h3>
      <ul class="list-group" aria-owns="first second third">
        <li id="third" class="list-group-item">Third</li>
        <li id="second" class="list-group-item">Second</li>
        <li id="first" class="list-group-item">First</li>
      </ul>

      <h2>Building a list</h2>

      <p>Another use of aria-owns is to construct an ARIA list when there isn't
      a suitable container element as the parent of the list items.</p>

      <pre>
<xmp class="prettyprint">      <div role="list" class="list-group" aria-owns="item1 item2"></div>
      <div id="item1" role="listitem" class="list-group-item">Item One</div>
      <div id="item2" role="listitem" class="list-group-item">Item Two</div></xmp></pre>

      <h3>Without aria-owns</h3>
      <div role="list" class="list-group"></div>
      <div role="listitem" class="list-group-item">Item One</div>
      <div role="listitem" class="list-group-item">Item Two</div>

      <h3>With aria-owns</h3>
      <div role="list" class="list-group" aria-owns="item1 item2"></div>
      <div id="item1" role="listitem" class="list-group-item">Item One</div>
      <div id="item2" role="listitem" class="list-group-item">Item Two</div>

      <h2>Building a grid</h2>

      <p>Similarly aria-owns can be used to construct an ARIA grid.</p>

      <pre>
<xmp class="prettyprint">      <div role="grid" aria-owns="row1 row2"></div>
      <div id="row1" role="row">
        <div role="gridcell">Cell 1, 1</div>
        <div role="gridcell">Cell 1, 2</div>
        <div role="gridcell">Cell 1, 3</div>
      </div>
      <div id="row2" role="row">
        <div role="gridcell">Cell 2, 1</div>
        <div role="gridcell">Cell 2, 2</div>
        <div role="gridcell">Cell 2, 3</div>
      </div></xmp></pre>

      <h3>Without aria-owns</h3>
      <div role="grid"></div>
      <div role="row">
        <div role="gridcell">Cell 1, 1</div>
        <div role="gridcell">Cell 1, 2</div>
        <div role="gridcell">Cell 1, 3</div>
      </div>
      <div role="row">
        <div role="gridcell">Cell 2, 1</div>
        <div role="gridcell">Cell 2, 2</div>
        <div role="gridcell">Cell 2, 3</div>
      </div>

      <h3>With aria-owns</h3>
      <div role="grid" aria-owns="row1 row2"></div>
      <div id="row1" role="row">
        <div role="gridcell">Cell 1, 1</div>
        <div role="gridcell">Cell 1, 2</div>
        <div role="gridcell">Cell 1, 3</div>
      </div>
      <div id="row2" role="row">
        <div role="gridcell">Cell 2, 1</div>
        <div role="gridcell">Cell 2, 2</div>
        <div role="gridcell">Cell 2, 3</div>
      </div>

      <h2>Dynamic changes</h2>

      <p>Aria-owns should work correctly if aria-owns is dynamically added
         to an element.</p>

      <button id="own" class="btn btn-lg btn-danger">Add aria-owns to list</button>
      <div id="dynlist" role="list" class="list-group"></div>
      <div id="dynitem1" role="listitem" class="list-group-item">Item One</div>
      <div id="dynitem2" role="listitem" class="list-group-item">Item Two</div>

      <script>
        document.getElementById("own").addEventListener("click", function() {
          document.getElementById("dynlist").setAttribute("aria-owns", "dynitem1 dynitem2");
          document.getElementById("own").disabled = true;
        });
      </script>

      <p style="margin-top: 1em">
         Aria-owns should also work correctly if aria-owns references an element it
         that's not on the page, and it later gets added.</p>

      <div>
        <button id="add" class="btn btn-lg btn-danger">Add owned elements</button>
        <div id="dynlistb" role="list" class="list-group" aria-owns="dynitemb1 dynitemb2"></div>
        <div id="dynitemb1" role="listitem" class="list-group-item">Item One</div>
      </div>

      <script>
        document.getElementById("add").addEventListener("click", function() {
          var parent = document.getElementById("dynlistb").parentElement;
          var child = document.createElement("div");
          child.id = "dynitemb2";
          child.className = "list-group-item";
          child.setAttribute("role", "listitem");
          child.textContent = "Item Two";
          parent.appendChild(child);
          document.getElementById("add").disabled = true;
        });
      </script>

      <h2>References</h2>

      <p style="margin-bottom: 2em;">
      <a href="http://www.w3.org/TR/wai-aria/states_and_properties#aria-owns">aria-owns</a>
      in the ARIA spec.
      </p>

    </div>

  </body>
</html>
